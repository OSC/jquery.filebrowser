<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Example of jQuery Browse</title>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="../js/jquery.filebrowser-src.js"></script>
  <script src="http://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
  <link href="http://code.jquery.com/ui/1.12.1/themes/dark-hive/jquery-ui.css" rel="stylesheet"/>
  <link href="../css/jquery.filebrowser-src.css" rel="stylesheet"/>
  <style>
body {
	margin: 0;
}
.browser {
	float: left;
	border: 1px solid gray;
	width: 300px;
	height: 200px;
	margin: 20px;
}
.browser.selected {
	border-color: blue;
}
  </style>
  <script>
$(function() {
	var env = {
		'foo': {
			'foo.txt': 'foo.txt content',
			'bar.txt': 'bar.txt content'
		},
		'bar': {
			'page.html': '<html></html>',
			'style.css': 'body { overflow: scroll; }'
		},
		'baz.txt': 'baz.txt content',
		'quux.txt': 'quux.txt content',
		'lorem.svg': 'lorem.svg content',
		'ipsum.doc': 'ipsum.doc content',
		'dolor.txt': 'dolor.txt content',
		'sit.jpg': 'sit.jpg content',
		'amet.gif': 'amet.gif content'
	};
	function get(path) {
		var current = env;
		browser.walk(path, function(file) {
			current = current[file];
		});
		return current;
	}
	function process(src, dest, remove) {
		console.log('process ' + src + ' => ' + dest);
		var file = env;
		var name;
		browser.walk(src, function(part, last) {
			var src = file[part];
			if (last) {
				if (remove) {
					delete file[part];
				}
			}
			file = src;
		});
		var current = env;
		browser.walk(dest, function(part, last) {
			if (!last) {
				current = current[part];
			} else {
				name = part;
			}
		});
		current[name] = file;
		
	}
	$('.browser').browse({
		root: '/',
		separator: '/',
		name: 'filestystem',
		rename: function(src, dest) {
			process(src, dest, true);
		},
		refresh_timer: 0,
		copy: process,
		dir: function(path, callback) {
			dir = get(path);
			if ($.isPlainObject(dir)) {
				var result = {files:[], dirs: []};
				Object.keys(dir).forEach(function(key) {
					if (typeof dir[key] == 'string') {
						result.files.push(key);
					} else if ($.isPlainObject(dir[key])) {
						result.dirs.push(key);
					}
				});
				callback(result);
			}
		},
		open: function(filename) {
			var file = get(filename);
			if (typeof file == 'string') {
				alert(file);
			}
		}
	});
	var browser = $('.browser').eq(0).browse();
});
  </script>
</head>
	<div class="browser"></div>
	<div class="browser"></div>
<body>
</body>
</html>